<style>
    @keyframes bblFadInOut {
        0%, 80%, 100% { box-shadow: 0 2.5em 0 -1.3em }
        40% { box-shadow: 0 2.5em 0 0 }
    }

    .loader,
    .loader::before,
    .loader::after {
        border-radius: 50%;
        width: 2.5em;
        height: 2.5em;
        animation-fill-mode: both;
        animation: bblFadInOut 1.8s infinite ease-in-out;
    }

    .loader {
        color: #FFF;
        font-size: 7px;
        position: relative;
        text-indent: -9999em;
        transform: translateZ(0);
        animation-delay: -0.16s;
    }

    .loader::before,
    .loader::after {
        content: '';
        position: absolute;
        top: 0;
    }

    .loader::before {
        left: -3.5em;
        animation-delay: -0.32s;
    }

    .loader::after {
        left: 3.5em;
    }

    .hide {
        display: none !important;
    }

    .ta-center {
        text-align: center;
    }

    .newsletter {
        margin: 0;
        padding: 0;
        border: 0;
    }

    .newsletter * {
        font-family: 'TT Norms Pro', sans-serif;
        line-height: 1.5;
        letter-spacing: normal;
        vertical-align: baseline;
        text-transform: none;
        text-rendering: optimizeLegibility;
        color: #424242;
    }

    .newsletter a,
    .newsletter a:hover,
    .newsletter a:active,
    .newsletter a:focus {
        outline: 0;
        text-decoration: none;
        color: #feebd0;
    }

    .newsletter h1,
    .newsletter h2,
    .newsletter h3,
    .newsletter h4,
    .newsletter h5,
    .newsletter h6,
    .newsletter p,
    .newsletter fieldset,
    .newsletter form {
        margin: 0;
        padding: 0;
        border: 0;
    }

    .newsletter form.newsletter-form {
        padding-top: 50px;
    }

    .newsletter-form-page {
        background-size: 100%;
        background-position: top;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
        width: 100%;
        height: 100%;
        color: #fff;
    }

    .newsletter-form-container {
        max-width: 80%;
        width: auto;
        background-color: #fff;
        margin: 200px auto;
        height: auto;
        padding: 60px 80px;
        position: relative;
    }

    .newsletter-section .newsletter-form-header {
        padding: 0;
        font-weight: bold;
        font-size: 32px;
        text-align: center;
        color: #3f000b;
    }

    .newsletter-section .newsletter-form-subheader {
        padding: 0 0 20px 0;
        font-weight: normal;
        font-size: 17px;
        text-align: center;
        color: #333;
    }

    .newsletter-form-page p {
        font-size: 18px;
        line-height: 24px;
        text-align: center;
    }

    .newsletter-form-page a {
        color: #3f000b;
        border-bottom-color: #3f000b;
    }

    .newsletter-form .form-field {
        margin-bottom: 2.4rem;
        margin-top: 0;
    }

    .newsletter-form .form-field label {
        margin-left: 20px;
    }

    .newsletter-form .field-wrapper label {
        font-weight: 700;
    }

    .newsletter-form span.imp {
        color: #333;
    }

    .newsletter-form label {
        margin-bottom: 8px;
        display: inline-block;
        color: #333;
        font-size: 1.5rem;
    }

    .newsletter-form label a {
        color: #3f000b;
    }

    .newsletter-form label a:hover,
    .newsletter-form label a:active,
    .newsletter-form label a:focus {
        outline: 0;
        text-decoration: underline dotted #3f000b;
        color: #3f000b;
    }

    .newsletter-form fieldset {
        display: flex;
        flex-wrap: wrap;
        border: 0;
    }

    .newsletter-form fieldset legend,
    .newsletter-form fieldset label {
        line-height: 24px;
        border-bottom: 0;
        color: #333;
    }

    .newsletter-form fieldset div input {
        margin: 0 10px 0 0;
    }

    .newsletter-form fieldset.check-full div {
        width: 100%;
        margin: 20px 0 0 0;
    }

    .newsletter-form input[type='text'] {
        border: 2px solid #cfcfcf;
        font-size: 18px;
        padding: 5px 43px;
        color: #3f000b;
        width: 100%;
        border-radius: 6px;
        min-height: 50px;
        letter-spacing: 0.03em;
        font-weight: 400;
        appearance: none;
        outline: none;
    }

    .newsletter-form input[type="text"]:focus-visible {
        outline: 1px solid #3c131c;
        border-color: #3c131c;
    }

    .newsletter-form input[type='checkbox'] {
        position: relative;
        float: left;
        background-color: #fff;
        height: 20px;
        width: 20px;
        top: -26px;
        content: '';
        display: block;
        border: 2px solid #cfcfcf;
        border-radius: 3px;
        margin-right: 10px;
        appearance: none;
        outline: none;
    }

    .newsletter-form input[type="checkbox"]:focus-visible {
        outline: 1px solid #3c131c;
        border-color: #3c131c;
    }

    .newsletter-form input[type="checkbox"]:checked {
        border-color: #3c131c;
        background-color: #3c131c;
    }

    .newsletter-form input[type="checkbox"]:checked::after {
        content: "✔";
        color: white;
        font-size: 16px;
        font-weight: bold;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
    }

    .newsletter-form input[type='checkbox'] + label {
        text-transform: none;
        font-size: 1.6rem;
        font-weight: 500;
        display: block;
        width: calc(100% - 27px);
        margin-left: 27px;
        margin-top: -2.8rem;
    }

    .newsletter-form input::placeholder {
        color: #333;
        font-weight: normal;
        font-size: 14px;
    }

    .newsletter-form button {
        position: relative;
        padding: 16px 36px;
        border-radius: 5rem;
        border: 0;
        font-size: 2.1rem;
        max-width: 300px;
        width: 100%;
        margin: 15px auto 0;
        background-color: #007bbd;
        cursor: pointer;
        text-align: center;
        font-weight: 400;
        color: #fff;
        user-select: none;
    }

    .newsletter-form input:disabled,
    .newsletter-form button:disabled {
        opacity: 50%;
        cursor: default;
        user-select: none;
    }

    .newsletter-form button:not(:disabled):hover,
    .newsletter-form button:not(:disabled):active,
    .newsletter-form button:not(:disabled):focus {
        filter: brightness(1.15);
    }

    .newsletter-form button:not(:disabled):focus-visible {
        outline: 3px solid #3c131c;
    }

    .newsletter-form button span.loader {
        position: absolute;
        z-index: 0;
        top: calc(50% - 2.5em);
        left: 50%;
        transform: translate(-50%, -50%);
    }

    .newsletter-form button span.label,
    .newsletter-form.loading button span.loader {
        visibility: visible;
    }

    .newsletter-form button span.loader,
    .newsletter-form.loading button span.label {
        visibility: hidden;
    }

    .newsletter-form .input-container {
        position: relative;
    }

    .newsletter-form .input-container i {
        position: absolute;
        left: 12px;
        top: 50%;
        transform: translateY(-50%);
        color: #333;
    }

    .newsletter-form .error {
        display: block;
        width: 100%;
        color: #eb0029;
        font-size: 1.3rem;
        font-style: italic;
        letter-spacing: 0.01em;
        visibility: hidden;
    }

    .newsletter-form .field-wrapper .error {
        position: absolute;
        bottom: -20px;
        left: 10px;
        width: calc(100% - 10px);
    }

    .newsletter-form .check-full .error {
        float: left;
        clear: left;
        width: calc(100% - 27px);
        margin-left: 27px;
        margin-top: -8px;
    }

    .newsletter-form .input-container input.input-error:not(:checked) {
        color: #eb0029;
        border-color: #eb0029;
    }

    .newsletter-form .input-container input.input-error:not(:checked):focus-visible {
        outline-color: #eb0029;
    }

    .newsletter-form .input-container input.input-error ~ .error {
        visibility: visible;
    }

    .newsletter-form .input-container input.input-error ~ i {
        color: #eb0029;
    }

    .newsletter-100 {
        display: flex;
        justify-content: space-between;
        width: 100%;
        padding-left: 0;
    }

    .newsletter-50 {
        display: flex;
        flex-direction: column;
        width: 50%;
        padding-left: 0;
    }

    .newsletter-100 div:last-child input {
        margin-right: 0;
    }

    .field-wrapper {
        flex-direction: column;
    }

    .field-divider {
        width: 100%;
        margin-top: 10px;
        border-top: 1px solid #cfcfcf;
        height: 25px;
    }

    @media screen and (max-width: 600px) {
        .newsletter-100 {
            flex-direction: column;
        }

        .newsletter-50 {
            width: 100%;
        }

        .newsletter-form-container {
            max-width: 100%;
            padding: 60px 20px;
        }

        .newsletter-form .form-field {
            padding-left: 0;
            padding-right: 0;
        }
    }

    @media screen and (max-width: 1200px) {
        .newsletter-100 {
            flex-direction: column;
        }

        .newsletter-50 {
            width: 100%;
        }

        .newsletter-form-container {
            max-width: 100%;
        }

        .newsletter-form .form-field {
            margin-bottom: 10px;
        }

        .newsletter-form .input-container {
            margin-bottom: 20px;
        }
    }

    .success-wrap {
        background: rgba(255,241,201,1);
        border: 8px solid #ffe9af;
        border-radius: 30px;
        display: flex;
        align-items: center;
        padding-top: 15px;
        padding-bottom: 15px;
    }

    .success-wrap .success-img {
        width: 40%;
        padding: 10px;
    }

    .success-wrap .success-msg h2 {
        font-family: 'Gazpacho', serif;
        font-size: 32px;
        font-weight: 700;
        line-height: 40px;
        text-align: left;
        color: #3c131c;
    }

    .success-wrap .success-msg-wrap {
        width: 60%;
        text-align: left;
        padding-right: 20px;
    }

    .success-wrap .success-msg-wrap p {
        color: #3c131c;
        font-size: 18px;
        line-height: 30px;
        text-align: left;
        font-family: 'TT Norms Pro', sans-serif;
        font-weight: 450;
    }

    .success-wrap .socialshare-icons {
        float: left;
    }

    .success-wrap .socialshare-icons p {
        font-family: 'TT Norms Pro', sans-serif;
        font-size: 12px;
        font-weight: 450;
        line-height: 30px;
        text-align: left;
        margin-bottom: 0;
    }

    .success-wrap .socialshare-icons p i {
        color: #3c131c;
    }

    .success-wrap .socialshare-icons a {
        border: 0;
        margin-right: 10px;
        display: inline-block;
    }

    .success-wrap .socialshare-icons a i.fa-brands {
        font-size: 33px;
        font-weight: 400;
    }

    .success-wrap .socialshare-icons a i.fa-instagram {
        background: linear-gradient(216.3deg, #9638be 16.45%, #db2c76 36.97%, #f8772e 64.86%, #fed87a 91.44%);
        background-clip: text;
        color: transparent;
    }

    .success-wrap .socialshare-icons a i.fa-tiktok {
        color: #000000;
    }

    .success-wrap .socialshare-icons a i.fa-pinterest {
        color: #e60023;
    }

    .success-wrap .socialshare-icons a i.fa-youtube {
        color: #ff0000;
    }

    .success-wrap .socialshare-icons a i.fa-facebook {
        color: #316ff6;
    }

    .success-wrap .cta {
        background: #006fae;
        width: fit-content;
        max-width: 320px;
        color: #fff;
        font-family: 'TT Norms Pro', sans-serif;
        font-size: 17px;
        font-weight: 700;
        line-height: 21px;
        text-align: center;
        padding: 21px 26px;
        margin: 10px 20px 10px 0;
        border-radius: 5rem;
        border: 0;
        float: left;
        white-space: nowrap;
    }

    .success-wrap .cta:hover,
    .success-wrap .cta:active,
    .success-wrap .cta:focus {
        filter: brightness(1.15);
    }

    @media screen and (max-width: 780px) {
        .success-wrap {
            display: block;
            padding: 10px 10px 40px 10px;
        }

        .success-wrap .success-msg h2 {
            font-size: 24px;
            line-height: 30px;
            margin-bottom: 15px;
        }

        .success-wrap .success-msg-wrap {
            width: 100%;
            text-align: left;
            padding: 0 20px;
        }

        .success-wrap .success-msg-wrap p {
            font-size: 16px;
            line-height: 20px;
            margin-bottom: 15px;
        }

        .success-wrap .cta {
            float: none;
            display: block;
            width: 100%;
            max-width: 320px;
            margin-left: auto;
            margin-right: auto;
            padding: 16px;
        }

        .success-wrap .success-img {
            width: 70%;
            padding: 0;
            max-width: 370px;
            display: block;
            margin: 0 auto 15px auto;
        }

        .success-wrap .socialshare-icons {
            float: none;
            text-align: center;
            margin: 10px 0 0 0;
        }

        .success-wrap .socialshare-icons p {
            text-align: center;
        }

        .success-wrap .socialshare-icons a {
            margin: 0 5px;
        }
    }
</style>

<div class="newsletter">
    <div class="newsletter-form-page">
        <div class="newsletter-form-container">
            <section id="newsletter_register_form" class="newsletter-section">

                <h1 class="newsletter-form-header">Get Ready for Even More Hershey Goodness</h1>
                <h5 class="newsletter-form-subheader">
                    Join our twice-a-month newsletter and receive recipe inspiration, celebration ideas,
                    news on the latest candy innovations, contests and promotions, and more across Hershey's family of
                    brands.
                    Just tell us where to send it and where you're from.
                </h5>
                <p><small>Please note, visitors from countries in the EU/EEA should not use this form.</small></p>

                <form name="ProfileForm"
                      action="https://l.hersheys.com/u/register.php"
                      method="get"
                      class="newsletter-form">

                    <input type="hidden" name="CID" value="1095463636">
                    <input type="hidden" name="SID" value="">
                    <input type="hidden" name="UID" value="">
                    <input type="hidden" name="f" value="883">
                    <input type="hidden" name="p" value="2">
                    <input type="hidden" name="a" value="r">
                    <input type="hidden" name="el" value="">
                    <input type="hidden" name="llid" value="">
                    <input type="hidden" name="c" value="">
                    <input type="hidden" name="counted" value="">
                    <input type="hidden" name=",km cxfRID" value="">
                    <input type="hidden" name="mailnow" value="">
                    <input type="hidden" name="inp_14076" value=""><!-- Origin Site Source Placeholder -->

                    <div class="newsletter-100">
                        <div class="newsletter-50 field-wrapper col-md-6 col-xs-12 form-field">
                            <label for="inp_1">First Name <span class="imp">*</span></label>
                            <div class="input-container">
                                <input type="text" id="inp_1" name="inp_1" maxlength="60" tabindex="1"
                                       placeholder="Enter Your First Name"/>
                                <span class="error">Please provide your first name.</span>
                                <i class="fal fa-user" aria-hidden="true"></i>
                            </div>
                        </div>
                        <div class="newsletter-50 field-wrapper col-md-6 col-xs-12 form-field">
                            <label for="inp_2">Last Name <span class="imp">*</span></label>
                            <div class="input-container">
                                <input type="text" id="inp_2" name="inp_2" maxlength="60" tabindex="2"
                                       placeholder="Enter Your Last Name"/>
                                <span class="error">Please provide your last name.</span>
                                <i class="fal fa-user" aria-hidden="true"></i>
                            </div>
                        </div>
                    </div>

                    <div class="newsletter-100 field-wrapper col-xs-12 form-field col-md-12">
                        <label for="inp_3">Email <span class="imp">*</span></label>
                        <div class="input-container">
                            <input type="text" id="inp_3" name="inp_3" maxlength="255" tabindex="3"
                                   placeholder="Enter Your Email"/>
                            <span class="error">Please provide a valid email address.</span>
                            <i class="fal fa-envelope" aria-hidden="true"></i>
                        </div>
                    </div>

                    <div class="newsletter-100">
                        <div class="newsletter-50 field-wrapper col-md-6 col-xs-12 form-field">
                            <label for="inp_13">Zip Code <span class="imp">*</span></label>
                            <div class="input-container">
                                <input type="text" id="inp_13" name="inp_13" maxlength="16" tabindex="4"
                                       placeholder="Enter Your ZIP Code">
                                <span class="error">Please provide a valid zip code.</span>
                                <i class="fal fa-map-marker-alt" aria-hidden="true"></i>
                            </div>
                        </div>
                    </div>

                    <div class="field-divider"></div>

                    <fieldset class="check-full">
                        <div class="input-container">
                            <input type="checkbox" id="optin" name="optin" value="y" tabindex="5">
                            <label for="optin">
                                I’d like to receive product news, exciting offers, personalized content,
                                services and more from The Hershey Company and its affiliates and partners,
                                including through direct mail, digital media or digital communications.
                                For further information, please refer to our <a
                                    href="https://www.thehersheycompany.com/en_us/home/privacy-policy.html"
                                    target="self"
                                    tabindex="7"
                                    rel="noopener noreferrer">Privacy Policy</a>
                                <span class="imp">*</span>
                            </label>
                            <span class="error">Please accept the terms and conditions to continue.</span>
                        </div>
                    </fieldset>

                    <div class="newsletter-100">
                        <div class="col-sm-12 col-xs-12 ta-center">
                            <button type="submit" tabindex="6" aria-label="Sign Me Up">
                                <span class="label">Sign Me Up</span>
                                <span class="loader"></span>
                            </button>
                        </div>
                    </div>

                </form>
            </section>
            <section id="newsletter_thank_you_page" class="newsletter-section hide">
                <div class="success-wrap">
                    <img class="success-img" src="https://www.hersheyland.com/content/dam/hersheyland/en-us/Thank+you+image.png" alt="icon">
                    <div class="success-msg-wrap">
                        <div class="success-msg">
                            <h2>You have successfully subscribed!</h2>
                            <p>Check your inbox for a welcome email and connect with us on social media to see what's new.</p>
                        </div>
                        <a class="cta" href="/home">Explore Hersheyland</a>
                        <div class="socialshare-icons">
                            <p>Be social with us! Follow us using <i>@Hersheyland</i></p>
                            <a href="https://www.instagram.com/hersheyland" class="insta-icon"><i class="fa-brands fa-instagram"></i></a>
                            <a href="https://www.tiktok.com/@hersheyland" class="pinterest-icon"><i class="fa-brands fa-tiktok"></i></a>
                            <a href="https://www.youtube.com/channel/UCSwX_0zWjWH7eOtvUcGL64w" class="facebook-icon"><i class="fa-brands fa-youtube"></i></a>
                            <a href="https://www.facebook.com/people/Hersheyland/10009362778345" class="youtube-icon"><i class="fa-brands fa-facebook"></i></a>
                            <a href="https://www.pinterest.com/hersheyland" class="tiktok-icon"><i class="fa-brands fa-pinterest"></i></a>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </div>
</div>

<script language="javascript">
    function is_1_valid() {
        const input = document.querySelectorAll('form[name=ProfileForm] input[name=inp_1]').item(0);
        input.classList.remove('input-error');

        if (!input.value) {
            input.classList.add('input-error');
            return false;
        }

        return true;
    }

    function is_2_valid() {
        const input = document.querySelectorAll('form[name=ProfileForm] input[name=inp_2]').item(0);
        input.classList.remove('input-error');

        if (!input.value) {
            input.classList.add('input-error');
            return false;
        }

        return true;
    }

    function is_3_valid(fullCheck = true) {
        const input = document.querySelectorAll('form[name=ProfileForm] input[name=inp_3]').item(0);
        input.classList.remove('input-error');

        if (!input.value) {
            input.classList.add('input-error');
            return false;
        }

        if (!fullCheck) {
            return true;
        }

        // Email validation regex
        // https://stackoverflow.com/a/46181
        const isEmailValid = String(input.value)
            .toLowerCase()
            .trim()
            .match(
                /^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|.(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/
            );

        if (!isEmailValid) {
            input.classList.add('input-error');
            return false;
        }

        return true;
    }

    function is_13_valid(fullCheck = true) {
        const input = document.querySelectorAll('form[name=ProfileForm] input[name=inp_13]').item(0);
        input.classList.remove('input-error');

        if (!input.value) {
            input.classList.add('input-error');
            return false;
        }

        if (!fullCheck) {
            return true;
        }

        // ZIP code must be 5 digits (12345) or ZIP+4 format (12345-6789)
        // https://stackoverflow.com/a/160583
        const isZipValid = String(input.value)
            .toLowerCase()
            .trim()
            .match(
                /(^\d{5}$)|(^\d{5}-\d{4}$)/
            );

        if (!isZipValid) {
            input.classList.add('input-error');
            return false;
        }

        return true;
    }

    function is_optin_valid() {
        const input = document.querySelectorAll('form[name=ProfileForm] input[name=optin]').item(0);
        input.classList.remove('input-error');

        if (!input.checked) {
            input.classList.add('input-error');
            return false;
        }

        return true;
    }

    function checkInputs() {
        let isValid = true;

        isValid = is_1_valid() && isValid;
        isValid = is_2_valid() && isValid;
        isValid = is_3_valid() && isValid;
        isValid = is_13_valid() && isValid;
        isValid = is_optin_valid() && isValid;

        return isValid;
    }

    function populateHiddenFields() {
        const form = document.getElementsByName('ProfileForm').item(0);
        if (form instanceof HTMLFormElement) {
            // Origin Site Source Placeholder
            const inputElm = form.querySelectorAll('input[name=inp_14076]').item(0);
            const urlParams = new URLSearchParams(window.location.search);
            const newsbkg = urlParams.get('newsbkg');
            inputElm.value = (newsbkg && newsbkg.length > 0 && inputElm.value.length === 0)
                ? newsbkg : 'hersheyglobal';
        }
    }

    function submitForm() {
        const form = document.getElementsByName('ProfileForm').item(0);
        if (form instanceof HTMLFormElement) {
            form.classList.add('loading');
            populateHiddenFields();
            const data = new FormData(form);
            const dataObject = Object.fromEntries(data);
            const urlParams = new URLSearchParams(dataObject).toString();
            const url = `${form.action}?${urlParams}`;
            disableFormInputs();
            fetch(url, {
                method: form.method,
                mode: 'no-cors',
                headers: {
                    'Content-Type': 'multipart/form-data',
                },
            }).then(() => {
                scrollToFormTop();
                setTimeout(() => { onSubmitComplete(); }, 500);
            }).catch(error => {
                enableFormInputs();
                onSubmitError(error);
            }).finally(() => {
                form.classList.remove('loading');
            });
        }
    }

    function getOffsetTop(element) {
        let offsetTop = 0;
        while (element) {
            offsetTop += element.offsetTop;
            element = element.offsetParent;
        }

        offsetTop -= 100;
        if (offsetTop < 0) offsetTop = 0;

        return offsetTop;
    }

    function scrollToFormTop() {
        const formContainer = document.getElementById('newsletter_register_form');
        let offset = getOffsetTop(formContainer) - 50;
        if (offset < 0) offset = 0;
        window.scrollTo({
            top: offset,
            behavior: 'smooth',
        });
    }

    function scrollToFirstInputError() {
        const form = document.getElementsByName('ProfileForm').item(0);
        if (form instanceof HTMLFormElement) {
            const elements = form.querySelectorAll('input.input-error');
            if (elements.length > 0) {
                const element = elements.item(0);
                element.focus();
                window.scrollTo({
                    top: getOffsetTop(element),
                    behavior: 'smooth',
                });
            }
        }
    }

    function enableFormInputs() {
        const form = document.getElementsByName('ProfileForm').item(0);
        if (form instanceof HTMLFormElement) {
            const elements = form.elements;
            for (let i = 0; i < elements.length; i++) {
                elements[i].disabled = false;
            }
        }
    }

    function disableFormInputs() {
        const form = document.getElementsByName('ProfileForm').item(0);
        if (form instanceof HTMLFormElement) {
            const elements = form.elements;
            for (let i = 0; i < elements.length; i++) {
                elements[i].disabled = true;
            }
        }
    }

    function onSubmitComplete() {
        document.getElementById('newsletter_register_form').classList.add('hide');
        document.getElementById('newsletter_thank_you_page').classList.remove('hide');
    }

    function onSubmitError(error) {
        console.error('Form submission failed:', error);
    }

    function checkLocalStorage() {
        const value = localStorage.getItem('email');
        const form = document.getElementsByName('ProfileForm').item(0);
        if (value !== null && form instanceof HTMLFormElement) {
            const input = form.querySelectorAll('input[name=inp_3]').item(0);
            if (input instanceof HTMLInputElement) {
                input.value = value;
            }
        }
    }

    function bindFormSubmitEvent() {
        const form = document.getElementsByName('ProfileForm').item(0);
        if (form instanceof HTMLFormElement) {
            form.addEventListener('submit', function(event) {
                event.preventDefault();
                event.stopPropagation();
                if (checkInputs()) submitForm(form);
                else scrollToFirstInputError();
            });
        }
    }

    function bindInputChangeEvents() {
        let previousValues = [];

        const form = document.getElementsByName('ProfileForm').item(0);
        const inputs = form.getElementsByTagName('input');
        for (let i = 0; i < inputs.length; i++) {
            const input = inputs[i];
            if (!input || input.type === 'hidden') {
                continue;
            }

            input.addEventListener('focus', (event) => {
                previousValues[i] = event.target.value;
            });

            input.addEventListener('keyup', (event) => {
                const hasError = event.target.classList.contains('input-error');
                const currentValue = event.target.value;
                const previousValue = previousValues[i];
                const valueChanged = currentValue !== previousValue;
                if (valueChanged || hasError) {
                    switch (event.target.name) {
                        case 'inp_1': is_1_valid(); break;
                        case 'inp_2': is_2_valid(); break;
                        // we do not want to validate email addresses while typing
                        // we only want to check if the field is empty
                        case 'inp_3': is_3_valid(hasError); break;
                        case 'inp_13': is_13_valid(hasError); break;
                        case 'optin': is_optin_valid(); break;
                    }
                }
            });

            input.addEventListener('change', (event) => {
                switch (event.target.name) {
                    case 'inp_1': is_1_valid(); break;
                    case 'inp_2': is_2_valid(); break;
                    case 'inp_3': is_3_valid(); break;
                    case 'inp_13': is_13_valid(); break;
                    case 'optin': is_optin_valid(); break;
                }
            });
        }
    }
</script>

<script language="javascript">
    let multiFields = [];
    let dateFields = [];
    window.multiFields = multiFields;
    window.dateFields = dateFields;
</script>

<script language="javascript" src="https://l.hersheys.com/u/nprefill.js" type="text/javascript"></script>
<script language="javascript">
    document.addEventListener('DOMContentLoaded', function() {
        checkLocalStorage();
        bindFormSubmitEvent();
        bindInputChangeEvents();
        // see: https://l.hersheys.com/u/nprefill.js
        if (typeof window['preFill'] === 'function') {
            window['preFill']();
        }
    });
</script>
